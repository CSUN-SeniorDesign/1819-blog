---
title: "Matabit Mario Week 24"
date: 2019-03-28T23:37:10-07:00
draft: false
tags: ["Mario Kassab ", "Matabit", "Week 24"]
layout: 'posts'
---

# Week 24 
Spring break week threw us off a bit as we didn't meet as much as we would during a regular school week, me and mark managed to meet for several hours and get some stuff accomplished on the servers. So this week we had to crunch a lot to catch up on the time we missed. First thing I ran into with our servers was I couldn't ssh into the new firewall A @ ip address 130.166.240.19 which was the old firewall A's IP. The issue was with the ssh key, I had to remove the old ssh key and generate a new one to gain access into the firewall. We had this issue before when we wanted the new firewall A to take over the old firewall A. After figuring that out, I had to continue where I left off last which was modifying the netplan yaml file and change the 3 interfaces so we are able to ssh into the servers from the host machine without having to be on the same network. I changed all the interfaces to the old IP's we had that originally crashed the machine before removing the ssh keys file. The machine accepted the change which leaves us off to test the changes and see if we are able to ssh into the servers. From my host machine I can only ssh into the 130.166.240.19 IP address as well as ping it which what we want. For the other 3 interfaces we cannot ping nor ssh into them from the host which is what's suppose to happen. However, if you are on one of the other machines such as old firewall B, you can ssh and ping any of the IP's which makes sense and suppose to happen. As of now our new firewall A is up and ready to go on the DHCP side. Next we have to configure the DNS side of things. 

After figuring out the network configurations we tackled the DNS and did some testing. First we pinged from firewall A the ping worked but we wanted to find out for sure where it was working from. Turns out it was working from the old firewall B, both servers had bind9 active and running. In order to test this, first thing we did was turn off the bind9 from new firewall A. The ping still worked from firewall A because it was pointing to old firewall B, which bind9 was still on. I pinged csun.edu from old B and it worked. Next, I looked at the netplan to see where DNS is coming from, it gave me two options which were new firewall A, but couldn't be because DNS was off, and the second option was loop back of the host machine. We then turned off bind9 for old B, and the ping to csun.edu failed. Same from new A the ping failed, good! For the real test we turned on DNS for new A and pinged csun.edu and it was successful. This tells us that new A's DNS is now up and running and can ping domain names and IP's. Took screenshots for proof and documentation. 

After making sure new A was fine now we had to configure new A and old A and switch interfaces that way new A will take over old A's configuration. In the netplan file I made sure the ip's were correct for both old and new A. I also identified which ilo ports belonged to what servers. As of now we turned off all the services like DHCP, DNS, and Firewall for old firewall A. One thing we did discover about the old A is that it has a floating IP address of 130.166.240.18. A Floating IP is an IP address that can be instantly moved from one Droplet to another Droplet in the same data center. Part of a available infrastructure is being able to immediately point an IP address to a redundant server. We found out that the floating IP, 130.166.240.18 when you try to ssh to it, redirects you to old A no matter what for some reason. We tried to add .18 to netplan for both new A&B so it redirects to new A instead, but that didn't really work. We turned off old A to force the floating IP to point to the new firewalls, but it times out. It also stops us from ssh-ing into Lorentz’s machine so we turned old A back on. There may be a IP Table rule or firewall rule that makes the floating IP point to old A for some reason, or it may be using the MAC address to redirect it, since that explains why changing netplan doesn’t affect the floating IP.

## What's Next?
For next week, the plan is to figure out the floating IP issue, as well as configure DHCP, DNS, and the firewall for the new servers. 
